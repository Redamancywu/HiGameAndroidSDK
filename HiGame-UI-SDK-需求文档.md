# HiGame UI 组件库需求功能文档

## 项目概述

### 产品定位
HiGame UI 组件库是一个**通用的、模块化的 Android UI 解决方案**，专为移动应用提供标准化的用户界面组件，支持游戏和普通 App 无缝集成。

### 目标用户
- **游戏开发者**：Cocos Creator、Unity、原生游戏开发团队
- **App 开发者**：Android 原生应用、混合应用开发团队
- **企业客户**：需要统一 UI 规范的多产品线公司

### 核心价值
- **开箱即用**：提供完整的 UI 解决方案，无需重复开发
- **高度定制**：支持品牌化定制，满足不同产品需求
- **跨平台兼容**：同时支持游戏引擎和原生 App 集成
- **模块化设计**：按需引入，减少包体积

### 技术特性
- **实现技术**：Kotlin + Jetpack Compose
- **集成方式**：独立组件 + 透明容器
- **兼容性**：Android 5.0+ 全版本支持
- **性能优化**：轻量级设计，启动快速，内存占用低

---

## 组件库架构设计

### 应用场景支持
```
┌─────────────────────────────────────────────────────────────┐
│                   HiGame UI 组件库应用场景                     │
├─────────────────────────────────────────────────────────────┤
│  游戏应用集成                                                 │
│  ├── Cocos Creator 游戏    ├── Unity 游戏                   │
│  ├── 原生 Android 游戏     ├── 混合引擎游戏                  │
├─────────────────────────────────────────────────────────────┤
│  普通 App 集成                                               │
│  ├── 电商应用             ├── 社交应用                       │
│  ├── 工具应用             ├── 企业应用                       │
├─────────────────────────────────────────────────────────────┤
│  混合场景                                                    │
│  ├── 游戏+社区 App        ├── 应用内小游戏                   │
│  ├── 多产品线统一 UI      ├── 白标产品定制                   │
└─────────────────────────────────────────────────────────────┘
```

### UI 组件模块划分
| 组件模块 | 功能描述 | 适用场景 | 独立性 |
|----------|----------|----------|--------|
| **基础组件库** | 通用 UI 组件、主题系统 | 所有应用 | 核心依赖 |
| **登录组件** | 多种登录方式的统一界面 | 需要用户认证的应用 | 完全独立 |
| **分享组件** | 多平台分享功能界面 | 需要内容分享的应用 | 完全独立 |
| **用户中心组件** | 个人信息管理界面 | 有用户体系的应用 | 完全独立 |
| **通用弹窗组件** | 各类提示、确认弹窗 | 所有应用 | 完全独立 |
| **加载组件** | 加载状态、进度显示 | 所有应用 | 完全独立 |

### 集成方式支持
- **游戏集成**：透明 Activity 方式，不干扰游戏渲染
- **App 集成**：Fragment/View 方式，无缝嵌入原生界面
- **混合集成**：同时支持两种方式，灵活选择

### 设计原则
- ✅ **场景无关**：组件设计不依赖特定应用场景
- ✅ **高度解耦**：各组件间无强依赖关系
- ✅ **配置驱动**：通过配置实现不同的展示效果
- ✅ **品牌适配**：支持深度定制以匹配品牌风格

---

## UI 组件功能需求

## 1. 基础组件库

### 1.1 通用 UI 组件需求
- **按钮组件**：支持多种样式（填充、描边、文字、图标）、状态（正常、按下、禁用、加载）
- **输入框组件**：支持文本、密码、数字输入，带验证状态显示
- **弹窗组件**：支持模态、非模态弹窗，可自定义内容区域
- **底部面板组件**：支持滑出动画，可拖拽关闭
- **加载组件**：支持多种加载动画样式，可显示进度和文字
- **提示组件**：支持成功、警告、错误等不同类型提示

### 1.2 主题系统需求
- **颜色主题**：支持主色调、辅助色、背景色、文字色等完整色彩体系
- **字体主题**：支持标题、正文、说明文字等不同层级字体规范
- **形状主题**：支持圆角、边框等形状规范
- **尺寸主题**：支持间距、高度、宽度等尺寸规范
- **动画主题**：支持统一的动画时长和缓动效果

### 1.3 响应式设计需求
- **屏幕适配**：支持不同屏幕尺寸和分辨率自动适配
- **方向适配**：支持横屏、竖屏自动布局调整
- **密度适配**：支持不同屏幕密度的图标和文字适配
- **无障碍支持**：支持 TalkBack 等无障碍功能

### 1.4 国际化需求
- **多语言支持**：支持中文、英文等多语言切换
- **文字方向**：支持从左到右、从右到左的文字方向
- **日期格式**：支持不同地区的日期时间格式
- **数字格式**：支持不同地区的数字和货币格式

---

## 2. 登录 UI 模块（HiGameLoginView）

### 2.1 模块依赖
- **业务依赖**：`hi-game-auth`（认证服务）
- **UI 依赖**：`hi-game-common-ui`（基础组件）
- **数据流**：UI 事件 → AuthService → 网络请求 → 回调 UI
=======
---

## UI 模块详细设计

## 1. 公共 UI 基础模块（HiGameCommonUI）

### 1.1 基础组件库
```java
// 通用 UI 组件
public class HiGameButton extends View { ... }
public class HiGameInputField extends View { ... }
public class HiGameDialog extends Dialog { ... }
public class HiGameBottomSheet extends BottomSheetDialog { ... }
public class HiGameLoadingView extends View { ... }
public class HiGameToast { ... }
```

### 1.2 主题系统
```java
public class HiGameTheme {
    // 颜色主题
    public static class Colors {
        public int primary;
        public int secondary;
        public int accent;
        public int background;
        public int surface;
        public int error;
        public int onPrimary;
        public int onSecondary;
        // ...
    }
    
    // 字体主题
    public static class Typography {
        public int h1, h2, h3, h4, h5, h6;
        public int body1, body2;
        public int caption, overline;
        public String fontFamily;
    }
    
    // 形状主题
    public static class Shapes {
        public int smallCornerRadius;
        public int mediumCornerRadius;
        public int largeCornerRadius;
    }
}
```

### 1.3 动画系统
```java
public class HiGameAnimations {
    public static final int DURATION_SHORT = 150;
    public static final int DURATION_MEDIUM = 300;
    public static final int DURATION_LONG = 500;
    
    public static Animation fadeIn(int duration);
    public static Animation slideUp(int duration);
    public static Animation scaleIn(int duration);
    // ...
}
```

### 1.4 状态管理接口
```java
public interface HiGameUIState<T> {
    void onLoading();
    void onSuccess(T data);
    void onError(String message);
    void onEmpty();
}

public abstract class HiGameBaseViewModel {
    protected HiGameEventBus eventBus;
    protected HiGameConfigProvider configProvider;
    // ...
}
```

---

## 2. 登录组件功能需求

### 2.1 登录方式支持
- **第三方登录**：微信、QQ、Apple ID、Google、Facebook、Twitter
- **手机号登录**：短信验证码、语音验证码
- **邮箱登录**：邮箱+密码、邮箱验证码
- **用户名登录**：用户名+密码
- **游客登录**：一键游客身份登录
- **生物识别**：指纹、面部识别（系统支持时）

### 2.2 界面展示样式
- **全屏模式**：独立页面展示，适合游戏和独立登录场景
- **弹窗模式**：模态弹窗展示，适合 App 内登录场景
- **底部面板**：从底部滑出，适合快速登录场景
- **嵌入模式**：作为 Fragment 嵌入现有页面

### 2.3 UI 定制需求
- **背景定制**：支持纯色、渐变、图片背景
- **Logo 定制**：支持自定义 Logo 图片和尺寸
- **色彩定制**：支持主色调、按钮色、文字色定制
- **布局定制**：支持登录方式排列、间距、圆角等调整
- **文案定制**：支持所有文字内容自定义
- **品牌定制**：支持完整的品牌风格适配

### 2.4 交互功能需求
- **输入验证**：实时验证用户输入格式
- **错误提示**：友好的错误信息展示
- **加载状态**：登录过程中的加载动画
- **记住登录**：支持记住用户选择的登录方式
- **快速切换**：不同登录方式间的快速切换
- **键盘适配**：软键盘弹出时的界面适配

### 2.5 安全功能需求
- **防暴力破解**：登录失败次数限制
- **验证码保护**：图形验证码、滑动验证
- **设备绑定**：可选的设备安全验证
- **隐私保护**：密码输入的安全处理
### 2.6 状态管理需求
- **登录状态**：已登录、未登录、登录中、登录失败
- **网络状态**：网络正常、网络异常、超时处理
- **表单状态**：输入验证、提交状态、重置状态
- **会话管理**：登录会话保持、自动续期、安全登出

### 2.7 数据回调需求
- **登录成功**：返回用户信息、认证令牌、登录方式
- **登录失败**：返回错误码、错误信息、失败原因
- **登录取消**：用户主动取消登录操作
- **状态变化**：登录过程中的状态变化通知

---

## 3. 分享组件功能需求

### 3.1 分享平台支持
- **社交平台**：微信好友、微信朋友圈、QQ、QQ空间、微博、Facebook、Twitter
- **通讯工具**：短信、邮件、钉钉、企业微信
- **系统功能**：复制链接、保存图片、系统分享面板
- **自定义渠道**：支持接入其他第三方分享平台

### 3.2 分享内容类型
- **文本分享**：纯文本内容分享
- **图片分享**：单图、多图分享
- **链接分享**：网页链接+缩略图+描述
- **视频分享**：视频文件或视频链接分享
- **音频分享**：音频文件分享
- **小程序分享**：微信小程序卡片分享

### 3.3 界面展示样式
- **网格弹窗**：图标网格布局的模态弹窗
- **底部抽屉**：从底部滑出的分享面板
- **全屏预览**：全屏展示分享内容+分享选项
- **横向滚动**：水平滚动的分享选项列表

### 3.4 UI 定制需求
- **面板样式**：背景色、圆角、阴影等样式定制
- **图标定制**：分享渠道图标自定义
- **布局定制**：网格列数、间距、排列方式
- **文案定制**：标题、渠道名称、按钮文字
- **动画定制**：弹出、消失动画效果

### 3.5 交互功能需求
- **内容预览**：分享前预览分享内容
- **渠道筛选**：根据内容类型自动筛选可用渠道
- **快速分享**：常用渠道的快速分享功能
- **分享历史**：记录用户分享偏好
- **批量操作**：支持同时分享到多个平台

### 3.6 内容处理需求
- **图片处理**：自动压缩、格式转换、尺寸适配
- **链接处理**：自动获取网页标题、描述、缩略图
- **文本处理**：长文本截断、特殊字符处理
- **多媒体处理**：视频缩略图生成、音频信息提取

### 3.7 状态管理需求
- **分享状态**：准备中、分享中、分享成功、分享失败
- **网络状态**：在线、离线、网络异常处理
- **权限状态**：分享权限检查和申请
- **平台状态**：第三方平台可用性检测

### 3.8 数据回调需求
- **分享成功**：返回分享平台、分享时间、分享内容
- **分享失败**：返回错误码、错误信息、失败平台
- **分享取消**：用户取消分享操作
- **分享统计**：分享数据统计和分析

---

## 4. 用户中心组件功能需求

### 4.1 用户信息展示
- **基础信息**：头像、昵称、用户ID、等级、积分
- **认证状态**：实名认证、手机认证、邮箱认证状态
- **会员信息**：会员等级、到期时间、特权说明
- **统计数据**：登录天数、使用时长、活跃度等
- **扩展信息**：支持自定义用户属性展示

### 4.2 账号管理功能
- **绑定管理**：第三方账号绑定/解绑（微信、QQ、手机等）
- **安全设置**：密码修改、安全问题设置
- **隐私设置**：隐私权限、数据使用授权
- **设备管理**：登录设备查看、异常设备踢出
- **注销账号**：账号注销申请和确认流程

### 4.3 界面展示样式
- **全屏模式**：独立页面展示，适合完整的用户中心
- **弹窗模式**：模态弹窗展示，适合快速操作
- **侧滑模式**：从侧边滑出，适合导航式用户中心
- **嵌入模式**：作为 Fragment 嵌入现有页面

### 4.4 菜单系统需求
- **系统菜单**：设置、帮助、关于、隐私政策、用户协议
- **业务菜单**：客服、反馈、邀请好友、版本更新
- **自定义菜单**：支持添加自定义功能入口
- **菜单分组**：支持菜单分类和分组显示
- **权限控制**：根据用户权限动态显示菜单

### 4.5 UI 定制需求
- **头部定制**：背景图、用户信息布局、装饰元素
- **头像定制**：形状、边框、默认头像、上传功能
- **菜单定制**：图标、文字、颜色、排列方式
- **主题定制**：整体色调、字体、间距适配
- **品牌定制**：Logo、品牌色、品牌元素集成

### 4.6 交互功能需求
- **信息编辑**：昵称、头像、个人资料在线编辑
- **状态同步**：用户信息变更的实时同步
- **操作确认**：重要操作的二次确认机制
- **加载状态**：数据加载和操作过程的状态显示
- **错误处理**：网络异常、操作失败的友好提示

### 4.7 数据管理需求
- **缓存机制**：用户信息本地缓存和更新策略
- **同步机制**：多端数据同步和冲突处理
- **备份恢复**：用户数据备份和恢复功能
- **数据导出**：用户数据导出功能（符合法规要求）

### 4.8 安全功能需求
- **操作验证**：敏感操作的身份验证
- **权限检查**：功能权限的动态检查
- **日志记录**：用户操作日志记录
- **异常监控**：异常操作的监控和报警

### 4.9 数据回调需求
- **菜单点击**：返回菜单类型、自定义数据
- **信息更新**：返回更新后的用户信息
- **绑定操作**：返回绑定/解绑结果和状态
- **登出操作**：返回登出结果和清理状态

---

## 5. 通用弹窗组件功能需求

### 5.1 弹窗类型支持
- **提示弹窗**：成功、警告、错误、信息提示
- **确认弹窗**：确认/取消、是/否选择
- **输入弹窗**：单行输入、多行输入、密码输入
- **选择弹窗**：单选、多选、列表选择
- **自定义弹窗**：支持自定义内容区域

### 5.2 展示样式需求
- **居中弹窗**：屏幕中央显示的模态弹窗
- **底部弹窗**：从底部滑出的弹窗
- **全屏弹窗**：全屏覆盖的弹窗
- **无背景弹窗**：透明背景的浮动弹窗

### 5.3 交互功能需求
- **点击外部关闭**：可配置的点击外部区域关闭
- **返回键处理**：Android 返回键的响应处理
- **拖拽关闭**：支持拖拽手势关闭弹窗
- **自动关闭**：定时自动关闭功能

---

## 6. 加载组件功能需求

### 6.1 加载样式支持
- **转圈加载**：经典的圆形旋转加载动画
- **进度条加载**：带百分比的进度条显示
- **骨架屏加载**：内容骨架的占位显示
- **自定义加载**：支持自定义加载动画

### 6.2 显示模式需求
- **全屏加载**：覆盖整个屏幕的加载状态
- **局部加载**：特定区域的加载状态
- **按钮加载**：按钮内的加载状态
- **列表加载**：列表数据的加载状态

### 6.3 功能特性需求
- **加载文案**：可自定义的加载提示文字
- **超时处理**：加载超时的处理机制
- **取消功能**：用户可取消的加载操作
- **重试功能**：加载失败后的重试机制

---

## 7. 组件库统一管理

### 7.1 初始化配置需求
- **全局初始化**：组件库的统一初始化入口
- **主题配置**：全局主题和样式配置
- **语言配置**：多语言和国际化配置
- **行为配置**：动画、交互行为配置

### 7.2 生命周期管理
- **应用生命周期**：与应用生命周期的绑定
- **内存管理**：组件的内存占用优化
- **资源管理**：图片、字体等资源的管理
- **缓存管理**：数据和配置的缓存策略

### 7.3 事件通信需求
- **组件间通信**：不同组件间的数据传递
- **状态同步**：全局状态的同步机制
- **事件监听**：组件状态变化的监听
- **回调管理**：统一的回调接口管理

### 7.4 配置管理需求
- **本地配置**：本地存储的配置管理
- **远程配置**：服务端配置的动态更新
- **用户偏好**：用户个性化设置的保存
- **A/B测试**：不同配置方案的测试支持

---

## 集成方案设计

### 8.1 游戏应用集成方案
- **透明 Activity 模式**：独立 Activity 承载 UI 组件，透明背景不干扰游戏渲染
- **回调桥接**：通过 JNI 或 UnitySendMessage 将结果回传给游戏引擎
- **生命周期管理**：与游戏主 Activity 的生命周期协调
- **资源隔离**：UI 组件资源与游戏资源隔离，避免冲突

### 8.2 普通 App 集成方案
- **Fragment 模式**：作为 Fragment 嵌入到现有 Activity 中
- **View 模式**：作为自定义 View 添加到现有布局中
- **Activity 模式**：独立 Activity 承载，适合全屏展示
- **Dialog 模式**：作为 Dialog 弹窗展示

### 8.3 混合集成方案
- **动态选择**：根据宿主应用类型自动选择最佳集成方式
- **配置驱动**：通过配置参数控制集成行为
- **兼容适配**：同时支持多种集成方式的兼容性适配

### 8.4 技术要求
- **最小 Android 版本**：API 21 (Android 5.0)
- **目标 Android 版本**：API 34 (Android 14)
- **开发语言**：Kotlin + Jetpack Compose
- **架构模式**：MVVM + Repository Pattern
- **依赖管理**：Gradle + Maven 仓库分发

### 8.5 性能要求
- **启动速度**：组件冷启动时间 < 300ms
- **内存占用**：单个组件运行时内存 < 30MB
- **包体积**：单个组件 AAR 文件 < 2MB
- **动画流畅度**：保持 60fps 的动画效果

### 8.6 兼容性要求
- **屏幕适配**：支持 4.0" - 12.0" 屏幕尺寸
- **分辨率适配**：支持 720p - 4K 分辨率
- **方向适配**：支持横屏、竖屏自动适配
- **系统适配**：支持原生 Android、MIUI、EMUI 等定制系统

---

## 交付物清单

### 9.1 组件库文件
- **基础组件库**：`higame-common-ui.aar` - 通用 UI 组件和主题系统
- **登录组件**：`higame-login-ui.aar` - 登录相关 UI 组件
- **分享组件**：`higame-share-ui.aar` - 分享相关 UI 组件
- **用户中心组件**：`higame-usercenter-ui.aar` - 用户中心 UI 组件
- **弹窗组件**：`higame-dialog-ui.aar` - 通用弹窗组件
- **加载组件**：`higame-loading-ui.aar` - 加载状态组件

### 9.2 集成支持文件
- **混淆规则**：`consumer-rules.pro` - 代码混淆保护规则
- **资源文件**：图标、字符串、主题、动画等资源
- **权限清单**：所需 Android 权限说明
- **依赖清单**：第三方库依赖说明

### 9.3 文档资料
- **集成指南**：游戏和 App 的详细集成步骤
- **API 文档**：所有公开接口的详细说明
- **定制指南**：UI 样式和主题定制方法
- **最佳实践**：使用建议和注意事项
- **常见问题**：FAQ 和问题解决方案

### 9.4 示例项目
- **游戏集成示例**：Cocos Creator、Unity 集成演示
- **App 集成示例**：原生 Android App 集成演示
- **定制化示例**：不同品牌风格的定制演示
- **完整功能演示**：所有组件功能的完整展示

### 9.5 开发工具
- **主题生成器**：可视化主题配置工具
- **预览工具**：组件效果预览工具
- **调试工具**：集成调试和问题诊断工具

---

## 开发计划

### 第一阶段：基础架构搭建（3-4周）
- **项目架构**：多模块 Gradle 项目结构设计
- **基础组件库**：通用 UI 组件、主题系统、动画系统
- **集成框架**：游戏和 App 的不同集成方式支持
- **配置系统**：全局配置管理和主题定制系统
- **工具链**：开发、构建、测试工具链搭建

### 第二阶段：核心组件开发（4-5周）
- **登录组件**：多种登录方式的 UI 实现和交互逻辑
- **分享组件**：多平台分享的 UI 实现和内容处理
- **用户中心组件**：用户信息展示和账号管理功能
- **弹窗组件**：各类通用弹窗的实现
- **加载组件**：多种加载状态的 UI 实现

### 第三阶段：集成适配开发（3-4周）
- **游戏集成**：Cocos Creator、Unity 等游戏引擎适配
- **App 集成**：Fragment、View、Activity 等集成方式
- **回调桥接**：不同平台的数据回调机制
- **生命周期管理**：与宿主应用的生命周期协调
- **资源管理**：资源隔离和冲突避免

### 第四阶段：测试优化阶段（3-4周）
- **功能测试**：所有组件功能的完整测试
- **兼容性测试**：不同 Android 版本和设备的兼容性
- **性能优化**：启动速度、内存占用、动画流畅度优化
- **集成测试**：在真实游戏和 App 中的集成测试
- **用户体验优化**：交互细节和视觉效果优化

### 第五阶段：文档和工具（2-3周）
- **文档编写**：集成指南、API 文档、定制指南
- **示例项目**：各种集成场景的完整示例
- **开发工具**：主题生成器、预览工具、调试工具
- **发布准备**：版本管理、发布流程、技术支持准备

---

## 质量保证

### 10.1 代码质量标准
- **代码规范**：遵循 Kotlin 官方编码规范和 Android 开发最佳实践
- **静态检查**：使用 Detekt、Lint 等工具进行代码静态分析
- **单元测试**：核心逻辑单元测试覆盖率 > 85%
- **UI 测试**：关键用户流程的 UI 自动化测试
- **代码审查**：所有代码变更必须经过 Code Review

### 10.2 性能质量标准
- **启动性能**：组件冷启动时间 < 300ms，热启动 < 100ms
- **内存性能**：单个组件运行时内存占用 < 30MB
- **包体积**：单个组件 AAR 文件大小 < 2MB
- **动画性能**：保持 60fps 的流畅动画效果
- **电池优化**：避免不必要的后台活动和资源占用

### 10.3 兼容性质量标准
- **系统版本**：支持 Android 5.0 (API 21) 到 Android 14 (API 34)
- **设备适配**：支持主流 Android 设备，屏幕尺寸 4.0" - 12.0"
- **分辨率适配**：支持 720p 到 4K 分辨率自动适配
- **系统定制**：兼容 MIUI、EMUI、ColorOS 等主流定制系统
- **引擎兼容**：支持 Cocos Creator、Unity、原生 Android 等平台

### 10.4 用户体验质量标准
- **响应速度**：用户操作响应时间 < 100ms
- **视觉一致性**：所有组件遵循统一的设计规范
- **交互友好性**：符合 Android Material Design 交互规范
- **错误处理**：友好的错误提示和异常处理机制
- **无障碍支持**：支持 TalkBack 等无障碍功能

### 10.5 安全质量标准
- **数据安全**：敏感数据加密存储和传输
- **接口安全**：API 接口参数校验和防护
- **权限安全**：最小权限原则，动态权限申请
- **代码安全**：防止代码注入和逆向工程
- **隐私保护**：符合 GDPR、个人信息保护法等法规要求

---

## 项目总结

### 11.1 产品价值
HiGame UI 组件库作为一个**通用的移动端 UI 解决方案**，为游戏和普通 App 开发者提供：

🎯 **开发效率提升**：开箱即用的 UI 组件，减少重复开发工作  
🎨 **品牌一致性**：统一的设计规范和深度定制能力  
🚀 **快速集成**：多种集成方式，适配不同应用场景  
📱 **跨平台兼容**：同时支持游戏引擎和原生 App  
🔧 **灵活扩展**：模块化设计，支持按需引入和功能扩展  

### 11.2 技术特色
- **现代化技术栈**：基于 Kotlin + Jetpack Compose 的现代 Android 开发
- **模块化架构**：清晰的模块划分和依赖关系
- **高度可定制**：从颜色主题到交互行为的全方位定制
- **性能优化**：轻量级设计，快速启动，低内存占用
- **广泛兼容**：支持多种集成方式和应用场景

### 11.3 应用前景
该组件库可广泛应用于：
- **游戏行业**：手游的登录、分享、用户中心等功能
- **移动应用**：各类 App 的通用 UI 需求
- **企业级应用**：统一的 UI 规范和品牌形象
- **白标产品**：快速定制不同品牌风格的产品

---

*本文档版本：v3.0 - 通用组件库版*  
*最后更新：2025年9月8日*  
*文档类型：功能需求文档*